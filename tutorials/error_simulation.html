<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Qubit Components" href="qubit.html"><link rel="prev" title="Parameters &amp; Optimisation" href="using_parameters.html">
        <link rel="prefetch" href="../_static/lightworks_logo.svg" as="image">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Error Simulation - Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #3e368d;
  --color-brand-content: #873bd4;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #9198cc;
  --color-brand-content: #9198cc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #9198cc;
  --color-brand-content: #9198cc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/lightworks_logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="circuit_building.html">Circuit Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_parameters.html">Parameters &amp; Optimisation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Error Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="qubit.html">Qubit Components</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sdk/index.html">SDK</a><input aria-label="Toggle navigation of SDK" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../sdk/photonic_circuit.html">PhotonicCircuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk/unitary.html">Unitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk/parameters.html">Parameter &amp; ParameterDict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk/state.html">State</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk/tasks.html">Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk/post_selection.html">Post-selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk/utilities.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../emulator/index.html">Emulator</a><input aria-label="Toggle navigation of Emulator" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../emulator/theory.html">Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/backend.html">Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/simulator.html">Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/sampler.html">Sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/imperfect_sampling.html">Imperfect Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/analyzer.html">Analyzer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../qubit/index.html">Qubit</a><input aria-label="Toggle navigation of Qubit" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../qubit/gates.html">Qubit Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qubit/conversion.html">Circuit Conversion</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../interferometers/index.html">Interferometers</a><input aria-label="Toggle navigation of Interferometers" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../interferometers/tutorial.html">Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tomography/index.html">Tomography</a><input aria-label="Toggle navigation of Tomography" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tomography/state_tomography.html">State Tomography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography/process_tomography.html">Process Tomography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography/gate_fidelity.html">Average Gate Fidelity</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><input aria-label="Toggle navigation of Examples" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/single_photon_demo.html">Single-photon Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/multi_photon_sampling.html">Multi-photon Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bell_state_generator.html">Bell State Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ralph_cnot.html">Ralph CNOT - All Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/heralded_cnot.html">Heralded CNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/3_qubit_GHZ_generation.html">3 Qubit GHZ Generation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sdk_reference/index.html">SDK Reference</a><input aria-label="Toggle navigation of SDK Reference" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/photonic_circuit.html">PhotonicCircuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/photonic_components.html">PhotonicComponents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/photonic_compiled_circuit.html">CompiledPhotonicCircuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/state.html">State</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/display.html">Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/parameters.html">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/unitary.html">Unitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/tasks.html">Tasks</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sdk_reference/results/index.html">Results</a><input aria-label="Toggle navigation of Results" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../sdk_reference/results/sampling_result.html">SamplingResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sdk_reference/results/simulation_result.html">SimulationResult</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_reference/utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../emulator_reference/index.html">Emulator Reference</a><input aria-label="Toggle navigation of Emulator Reference" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../emulator_reference/backend.html">Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator_reference/source.html">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator_reference/detector.html">Detector</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../qubit_reference/index.html">Qubit Reference</a><input aria-label="Toggle navigation of Qubit Reference" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../qubit_reference/qubit_gates.html">Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qubit_reference/converters.html">Converters</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../interferometers_reference/index.html">Interferometers Reference</a><input aria-label="Toggle navigation of Interferometers Reference" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../interferometers_reference/reck.html">Reck</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interferometers_reference/error_model.html">Error Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interferometers_reference/distributions.html">Distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tomography_reference/index.html">Tomography Reference</a><input aria-label="Toggle navigation of Tomography Reference" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tomography_reference/state_tomography.html">State Tomography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography_reference/process_tomography.html">Process Tomography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography_reference/gate_fidelity.html">Gate Fidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography_reference/experiments.html">Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography_reference/utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tomography_reference/projection.html">Projection</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/error_simulation.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Error-Simulation">
<h1>Error Simulation<a class="headerlink" href="#Error-Simulation" title="Link to this heading">¶</a></h1>
<p>Within Lightworks, it is possible to simulate a number of errors which can occur within linear optic systems, this includes loss, source &amp; detector imperfections. This notebook demonstrates the inclusion of each of these.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">seed</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lightworks</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lw</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lightworks</span><span class="w"> </span><span class="kn">import</span> <span class="n">emulator</span>
</pre></div>
</div>
</div>
<section id="Loss">
<h2>Loss<a class="headerlink" href="#Loss" title="Link to this heading">¶</a></h2>
<p>In photonic systems, loss is a critical error source which results in the erasure of quantum information from systems. For interferometric systems, imbalances in loss will also limit fidelity of the operations implemented. Losses in lightworks can be added to the system through the loss method.</p>
<p>To see the effect of this on a small system, below we add a loss element to a single output mode of a 50:50 beam splitter. The loss elements can be viewed with the display_loss option.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lossy_circuit</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">PhotonicCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">lossy_circuit</span><span class="o">.</span><span class="n">bs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reflectivity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">lossy_circuit</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="n">lossy_circuit</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">display_loss</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_3_0.svg" src="../_images/tutorials_error_simulation_3_0.svg" />
</div>
</div>
<p>When this circuit is then sampled with a single photon input, it can be seen how the probability distribution is skewed which could alter any conclusions derived from the results. Without loss, it is expected that both <span class="math notranslate nohighlight">\(\ket{1,0}\)</span> and <span class="math notranslate nohighlight">\(\ket{0,1}\)</span> would be seen in near equal amounts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Backend</span><span class="p">(</span><span class="s2">&quot;permanent&quot;</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">lossy_circuit</span><span class="p">,</span> <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">min_detection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_5_0.png" src="../_images/tutorials_error_simulation_5_0.png" />
</div>
</div>
<p>Scaling this up to a larger system, a lossy Reck interferometer can be configured and compared to the non-lossy equivalent. To achieve this we will parameterize the loss value and extract the unitary with and without loss.</p>
<p>It can also be seen how some components offer the option to include loss without adding these as additional elements.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_modes</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">interferometer</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">PhotonicCircuit</span><span class="p">(</span><span class="n">n_modes</span><span class="p">)</span>

<span class="c1"># Define parameter to set loss</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>

<span class="c1"># Set random seed to ensure repeatability</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_modes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_modes</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">interferometer</span><span class="o">.</span><span class="n">barrier</span><span class="p">(</span>
            <span class="p">[</span><span class="n">n_modes</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">,</span> <span class="n">n_modes</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">j</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># Use barrier to separate unit cells</span>

        <span class="c1"># Add randomly configured elements</span>
        <span class="n">interferometer</span><span class="o">.</span><span class="n">ps</span><span class="p">(</span><span class="n">n_modes</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">random</span><span class="p">())</span>
        <span class="n">interferometer</span><span class="o">.</span><span class="n">bs</span><span class="p">(</span>
            <span class="n">n_modes</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">,</span>
            <span class="n">reflectivity</span><span class="o">=</span><span class="n">random</span><span class="p">(),</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span>  <span class="c1"># Include loss on beam splitter</span>
        <span class="p">)</span>

<span class="n">interferometer</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">display_loss</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_7_0.svg" src="../_images/tutorials_error_simulation_7_0.svg" />
</div>
</div>
<p>Once the circuit is created, the unitary matrices are then extracted and plotted below. It can be seen how the implemented unitary transformation is altered in the presence of losses.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set loss to 0 and get unitary</span>
<span class="n">loss</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">U_ideal</span> <span class="o">=</span> <span class="n">interferometer</span><span class="o">.</span><span class="n">U</span>

<span class="c1"># Set loss to 0.2 and get unitary</span>
<span class="n">loss</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">U_lossy</span> <span class="o">=</span> <span class="n">interferometer</span><span class="o">.</span><span class="n">U</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">U_ideal</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">U_lossy</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_9_0.png" src="../_images/tutorials_error_simulation_9_0.png" />
</div>
</div>
</section>
<section id="Source-Imperfections">
<h2>Source Imperfections<a class="headerlink" href="#Source-Imperfections" title="Link to this heading">¶</a></h2>
<p>There are a number of imperfections that can be introduced within the Source. To view these, we’ll configure a basic Hong-Ou-Mandel (HOM) configuration, consisting of two input photons incident on a 50:50 beam splitter. When using a perfect source the <span class="math notranslate nohighlight">\(\ket{1,1}\)</span> input should produce an output of either <span class="math notranslate nohighlight">\(\ket{2,0}\)</span> or <span class="math notranslate nohighlight">\(\ket{0,2}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hom</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">PhotonicCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">hom</span><span class="o">.</span><span class="n">bs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reflectivity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">hom</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_11_0.svg" src="../_images/tutorials_error_simulation_11_0.svg" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Source imperfections can only be used with the Sampler.</p>
</div>
<section id="Indistinguishability">
<h3>Indistinguishability<a class="headerlink" href="#Indistinguishability" title="Link to this heading">¶</a></h3>
<p>Indistinguishability is a measure of how similar the photons are to each other. This alters the extent to which the photons interfere, affecting the fidelity of transformations which are implemented. The model used in Lightworks assumes an identical level of indistinguishability between all photons.</p>
<p>For the HOM setup, it can be seen how the presence of partial distinguishability introduces a <span class="math notranslate nohighlight">\(\ket{1,1}\)</span> component which should not be measured.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">indistinguishability</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">hom</span><span class="p">,</span> <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">99</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_14_0.png" src="../_images/tutorials_error_simulation_14_0.png" />
</div>
</div>
</section>
<section id="Purity">
<h3>Purity<a class="headerlink" href="#Purity" title="Link to this heading">¶</a></h3>
<p>Single photon purity is a measure of the multi-photon elements present in each time bin of the system. These typically result from the laser used to drive the single photon source and act as distinguishable photons to the generated photons from the source. When introducing this affect, it can be seen how a significant number of outputs with more than the two input photons are generated.</p>
<p>Particularly in a lossy environment this leads to errors as a seemingly valid output may be measured (i.e. it has the correct number of photons) but some of these photons may be from the impure element of the single photon source, and these would interact differently when propagating through the system.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">purity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">hom</span><span class="p">,</span> <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">99</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_16_0.png" src="../_images/tutorials_error_simulation_16_0.png" />
</div>
</div>
</section>
<section id="Brightness">
<h3>Brightness<a class="headerlink" href="#Brightness" title="Link to this heading">¶</a></h3>
<p>Brightness reflects the fact that a certain percentage of the time the single photon source will not emit a photon. This can lead to error but will also significantly increase the amount of samples that need to be extracted from the system.</p>
<p>Below, when less than ideal brightness is introduced it can be seen how a lot of the outputs no longer contain 2 output photons. Typically, this could be mitigated through the use of the option post_select = 2 in sample_N_inputs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">hom</span><span class="p">,</span> <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">99</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_18_0.png" src="../_images/tutorials_error_simulation_18_0.png" />
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Each imperfection introduced through the source object requires simulation of additional inputs, so using these can have a significant impact on simulation time.</p>
</div>
</section>
</section>
<section id="Detector-Imperfections">
<h2>Detector Imperfections<a class="headerlink" href="#Detector-Imperfections" title="Link to this heading">¶</a></h2>
<p>The exact specifications of detectors will affect the results when sampling from the system. These often need to be taken into account as it may limit or alter how certain applications are realized. The included affects are detector efficiency, dark counts and non photon number resolving detectors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Detector imperfections can only be used with the Sampler, adn dark counts + sub-unity efficiency require setting the sampling mode to ‘input’.</p>
</div>
<section id="Efficiency">
<h3>Efficiency<a class="headerlink" href="#Efficiency" title="Link to this heading">¶</a></h3>
<p>A non-ideal detector efficiency means that there is a probability that each output photon is not measured. This will increase the number of samples required and potentially alters the measured results.</p>
<p>Using the HOM experiment from above, it can be seen how similar to source brightness the imperfect detector efficiency creates outputs with less than 2 photons measured.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detector</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span><span class="n">efficiency</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">hom</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="mi">10000</span><span class="p">,</span>
    <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span>
    <span class="n">sampling_mode</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_21_0.png" src="../_images/tutorials_error_simulation_21_0.png" />
</div>
</div>
</section>
<section id="Dark-counts">
<h3>Dark counts<a class="headerlink" href="#Dark-counts" title="Link to this heading">¶</a></h3>
<p>With all photon detection methods, dark counts occur where a detection event is registered without a photon being present. In cases where the dark count rate is large this will alter then output states measured across other modes and so it is important to understand the effect of these.</p>
<p>Below, an empty input is used and the probabilistic nature of dark counts demonstrated. The dark counts rate is set with the p_dark argument and is defined as the probability of a dark count occurring within the detection time bin on a singular detector channel.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detector</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span><span class="n">p_dark</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">lw</span><span class="o">.</span><span class="n">PhotonicCircuit</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
    <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">),</span>
    <span class="mi">10000</span><span class="p">,</span>
    <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">sampling_mode</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="c1"># Collect dark counts per mode</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)),</span> <span class="n">counts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mode&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dark counts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_23_0.png" src="../_images/tutorials_error_simulation_23_0.png" />
</div>
</div>
</section>
<section id="Photon-Number-Resolving">
<h3>Photon Number Resolving<a class="headerlink" href="#Photon-Number-Resolving" title="Link to this heading">¶</a></h3>
<p>Typically, the SNSPDs used in photonic quantum computing are not able to resolve multiple photons. This means if two or more photons exit on a mode of the QPU then only one detection event will be registered.</p>
<p>Again, using the HOM experiment, we set the photon_counting option to False and it can be seen how the output states are now only <span class="math notranslate nohighlight">\(\ket{1,0}\)</span> or <span class="math notranslate nohighlight">\(\ket{0,1}\)</span>. This also means if there is loss within the system, we would not be able to distinguish between the <span class="math notranslate nohighlight">\(\ket{2,0}\)</span> and a <span class="math notranslate nohighlight">\(\ket{1,0}\)</span> state where 1 photon was lost from the system.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detector</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span><span class="n">photon_counting</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">hom</span><span class="p">,</span> <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">99</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_25_0.png" src="../_images/tutorials_error_simulation_25_0.png" />
</div>
</div>
</section>
</section>
<section id="Combining-All-Errors">
<h2>Combining All Errors<a class="headerlink" href="#Combining-All-Errors" title="Link to this heading">¶</a></h2>
<p>Now all of the potential error source have been introduced, we can add all of the errors into a single simulation and view the effect this has. In this case we choose to use a Hadamard and CNOT gate on a pair of dual-rail encoded to qubit to create a <span class="math notranslate nohighlight">\(\Phi^+\)</span> bell state.</p>
<p>We start by simulating the ideal case and as expected the only outputs measured are <span class="math notranslate nohighlight">\(\ket{1,0,1,0}\)</span> and <span class="math notranslate nohighlight">\(\ket{0,1,0,1}\)</span> (<span class="math notranslate nohighlight">\(\ket{1,0}\)</span> and <span class="math notranslate nohighlight">\(\ket{0,1}\)</span> in qubit language respectively).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Define loss parameter</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">bell_circuit</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">PhotonicCircuit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">to_add</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">to_add</span><span class="p">:</span>
    <span class="n">bell_circuit</span><span class="o">.</span><span class="n">bs</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">reflectivity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">bell_circuit</span><span class="o">.</span><span class="n">ps</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">bell_circuit</span><span class="o">.</span><span class="n">bs</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">reflectivity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">bell_circuit</span><span class="o">.</span><span class="n">ps</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># Then add required heralds</span>
<span class="n">bell_circuit</span><span class="o">.</span><span class="n">herald</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">bell_circuit</span><span class="o">.</span><span class="n">herald</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Define required post-selection</span>
<span class="n">post_select</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="o">==</span> <span class="mi">1</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Sampler</span><span class="p">(</span>
    <span class="n">bell_circuit</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">.</span><span class="n">State</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="mi">100000</span><span class="p">,</span>
    <span class="n">post_selection</span><span class="o">=</span><span class="n">post_select</span><span class="p">,</span>
    <span class="n">sampling_mode</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_27_0.png" src="../_images/tutorials_error_simulation_27_0.png" />
</div>
</div>
<p>The loss parameter is then updated to introduce loss, and the source and detector attribute of the Sampler are also updated. For the source, a brightness of 80%, purity of 90% &amp; indistinguishability of 90% is chosen and for the detector, efficiency of 80%, a dark count probability of <span class="math notranslate nohighlight">\(10^{-4}\)</span> and non photon number resolving is used. A number of error states can then be seen to be present in the system.</p>
<p>Interested users may wish to tweak these parameters to view the effect each has on the produced output result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">brightness</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">indistinguishability</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> <span class="n">purity</span><span class="o">=</span><span class="mf">0.90</span>
<span class="p">)</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">detector</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span>
    <span class="n">efficiency</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">p_dark</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">photon_counting</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_error_simulation_29_0.png" src="../_images/tutorials_error_simulation_29_0.png" />
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="qubit.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Qubit Components</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="using_parameters.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Parameters &amp; Optimisation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Aegiq Ltd.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/Aegiq/lightworks" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Error Simulation</a><ul>
<li><a class="reference internal" href="#Loss">Loss</a></li>
<li><a class="reference internal" href="#Source-Imperfections">Source Imperfections</a><ul>
<li><a class="reference internal" href="#Indistinguishability">Indistinguishability</a></li>
<li><a class="reference internal" href="#Purity">Purity</a></li>
<li><a class="reference internal" href="#Brightness">Brightness</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Detector-Imperfections">Detector Imperfections</a><ul>
<li><a class="reference internal" href="#Efficiency">Efficiency</a></li>
<li><a class="reference internal" href="#Dark-counts">Dark counts</a></li>
<li><a class="reference internal" href="#Photon-Number-Resolving">Photon Number Resolving</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Combining-All-Errors">Combining All Errors</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=57236720"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>